name: test

on:
  pull_request:
    branches: [main]
  workflow_dispatch:

jobs:
  job_id:
    runs-on: Linux
    permissions:
      contents: "read"
      id-token: "write"

    steps:
      # - uses: "actions/checkout@v4"
      # - uses: "google-github-actions/auth@v2"
      #   id: 'auth'
      #   with:
      #     project_id: ${{ secrets.GCP_PROJECT_ID }}
      #     workload_identity_provider: ${{ secrets.GCP_WORKLOAD_IDENTITY_PROVIDER }}
      #     service_account: ${{ secrets.VIEWER_SERVICE_ACCOUNT }}

      # - name: "Set up Cloud SDK"
      #   uses: "google-github-actions/setup-gcloud@v2"
      #   with:
      #     version: ">= 363.0.0"

      - run: |
          gcloud compute instances list
          gcloud compute instances start opea-n4-16c-128g \
            --project=${{ secrets.GCP_PROJECT_ID }} \
            --zone=us-east1-d \
            --silent

          gcloud compute instances stop opea-n4-16c-128g \
            --project=${{ secrets.GCP_PROJECT_ID }} \
            --zone=us-east1-d
